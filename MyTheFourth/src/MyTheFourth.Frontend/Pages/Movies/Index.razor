@page "/movies"

@inject IMoviesService MoviesService
@attribute [StreamRendering]

<ModuleNavigation CurrentPage="Filmes" Module="EPagesNavigationsKey.Home" />

@if(Movies == null) 
{
    <StarWarsLoader Text="Carregando..." />
}
else 
{
    <Catalog>
        @{
            if (Movies == null || !Movies.Any())
                @Constants.ErrorMessages.NoContent
            else
            {
                @foreach (var movie in Movies) 
                {
                    <CatalogDetail ImgUrl="@movie.ImgUrl" Name="@movie.Title" Link="@($"movies/{movie.Slug ?? movie.Id.ToString()}")"/>
                }
            }
        }
    </Catalog>
}

@code {
    private IEnumerable<Movie>? Movies;

    protected override async Task OnInitializedAsync() {

       Movies = await MoviesService.ListMoviesAsync();
    }
}    
